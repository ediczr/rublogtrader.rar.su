<!DOCTYPE html><html lang="ru-RU" prefix="og: http://ogp.me/ns#"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' /><link media="all" href="https://rublogtrader.rar.su/wp-content/cache/autoptimize/css/autoptimize_a956534720ee1514d6564ed8c0f433d5.css" rel="stylesheet" /><title>Работа с датой и временем в MQL4: полезные функции и переменные</title><meta name="description" content="Как работать с датой и временем при создании торговых советников на MQL4? Создаем функции работы со временем, таймер и открываем ордера." /><meta property="og:locale" content="ru_RU" /><meta property="og:type" content="article" /><meta property="og:title" content="Работа с датой и временем в MQL4: полезные функции и переменные" /><meta property="og:description" content="Как работать с датой и временем при создании торговых советников на MQL4? Создаем функции работы со временем, таймер и открываем ордера." /><meta property="og:url" content="https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/" /><meta property="og:site_name" content="Блог трейдера" /><meta property="article:published_time" content="2020-06-26T10:27:41+00:00" /><meta property="article:modified_time" content="2020-06-26T10:31:02+00:00" /><meta property="og:image" content="https://rublogtrader.rar.su/wp-content/uploads/2020/06/rabota-s-datoj-i-vremenem-v-mql4-poleznye-funkcii-i-peremennye.jpg" /><meta property="og:image:width" content="1200" /><meta property="og:image:height" content="630" /><meta property="og:image:type" content="image/jpeg" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:creator" content="@traderblog_net" /><meta name="twitter:site" content="@traderblog_net" /><meta name="twitter:label1" content="Написано автором" /><meta name="twitter:data1" content="Александр Паркер" /><meta name="twitter:label2" content="Примерное время для чтения" /><meta name="twitter:data2" content="2 минуты" /> <script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://rublogtrader.rar.su/#website","url":"https://rublogtrader.rar.su/","name":"\u0411\u043b\u043e\u0433 \u0442\u0440\u0435\u0439\u0434\u0435\u0440\u0430","description":"My WordPress Blog","publisher":{"@id":"https://rublogtrader.rar.su/#/schema/person/28382f0e81820f364e345a97d4203238"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://rublogtrader.rar.su/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"ru-RU"},{"@type":"ImageObject","@id":"https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/#primaryimage","inLanguage":"ru-RU","url":"https://rublogtrader.rar.su/wp-content/uploads/2020/06/rabota-s-datoj-i-vremenem-v-mql4-poleznye-funkcii-i-peremennye.jpg","contentUrl":"https://rublogtrader.rar.su/wp-content/uploads/2020/06/rabota-s-datoj-i-vremenem-v-mql4-poleznye-funkcii-i-peremennye.jpg","width":1200,"height":630,"caption":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0434\u0430\u0442\u043e\u0439 \u0438 \u0432\u0440\u0435\u043c\u0435\u043d\u0435\u043c \u0432 MQL4: \u043f\u043e\u043b\u0435\u0437\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435"},{"@type":"WebPage","@id":"https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/#webpage","url":"https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/","name":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0434\u0430\u0442\u043e\u0439 \u0438 \u0432\u0440\u0435\u043c\u0435\u043d\u0435\u043c \u0432 MQL4: \u043f\u043e\u043b\u0435\u0437\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435","isPartOf":{"@id":"https://rublogtrader.rar.su/#website"},"primaryImageOfPage":{"@id":"https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/#primaryimage"},"datePublished":"2020-06-26T10:27:41+00:00","dateModified":"2020-06-26T10:31:02+00:00","description":"\u041a\u0430\u043a \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0441 \u0434\u0430\u0442\u043e\u0439 \u0438 \u0432\u0440\u0435\u043c\u0435\u043d\u0435\u043c \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0442\u043e\u0440\u0433\u043e\u0432\u044b\u0445 \u0441\u043e\u0432\u0435\u0442\u043d\u0438\u043a\u043e\u0432 \u043d\u0430 MQL4? \u0421\u043e\u0437\u0434\u0430\u0435\u043c \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0440\u0430\u0431\u043e\u0442\u044b \u0441\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0435\u043c, \u0442\u0430\u0439\u043c\u0435\u0440 \u0438 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u043c \u043e\u0440\u0434\u0435\u0440\u0430.","breadcrumb":{"@id":"https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/#breadcrumb"},"inLanguage":"ru-RU","potentialAction":[{"@type":"ReadAction","target":["https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/"]}]},{"@type":"BreadcrumbList","@id":"https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"\u0413\u043b\u0430\u0432\u043d\u0430\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430","item":"https://rublogtrader.rar.su/"},{"@type":"ListItem","position":2,"name":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0434\u0430\u0442\u043e\u0439 \u0438 \u0432\u0440\u0435\u043c\u0435\u043d\u0435\u043c \u0432 MQL4: \u043f\u043e\u043b\u0435\u0437\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435"}]},{"@type":"Article","@id":"https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/#article","isPartOf":{"@id":"https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/#webpage"},"author":{"@id":"https://rublogtrader.rar.su/#/schema/person/28382f0e81820f364e345a97d4203238"},"headline":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0434\u0430\u0442\u043e\u0439 \u0438 \u0432\u0440\u0435\u043c\u0435\u043d\u0435\u043c \u0432 MQL4: \u043f\u043e\u043b\u0435\u0437\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435","datePublished":"2020-06-26T10:27:41+00:00","dateModified":"2020-06-26T10:31:02+00:00","mainEntityOfPage":{"@id":"https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/#webpage"},"wordCount":167,"commentCount":0,"publisher":{"@id":"https://rublogtrader.rar.su/#/schema/person/28382f0e81820f364e345a97d4203238"},"image":{"@id":"https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/#primaryimage"},"thumbnailUrl":"https://rublogtrader.rar.su/wp-content/uploads/2020/06/rabota-s-datoj-i-vremenem-v-mql4-poleznye-funkcii-i-peremennye.jpg","articleSection":["MQL4"],"inLanguage":"ru-RU","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/#respond"]}]},{"@type":["Person","Organization"],"@id":"https://rublogtrader.rar.su/#/schema/person/28382f0e81820f364e345a97d4203238","name":"\u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440 \u041f\u0430\u0440\u043a\u0435\u0440","image":{"@type":"ImageObject","@id":"https://rublogtrader.rar.su/#personlogo","inLanguage":"ru-RU","url":"https://rublogtrader.rar.su/wp-content/uploads/2019/06/cosmopolis-100x100.png","contentUrl":"https://rublogtrader.rar.su/wp-content/uploads/2019/06/cosmopolis-100x100.png","width":100,"height":100,"caption":"\u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440 \u041f\u0430\u0440\u043a\u0435\u0440"},"logo":{"@id":"https://rublogtrader.rar.su/#personlogo"},"description":"\u0421\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044c \u0438 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440 \u0441\u0430\u0439\u0442\u0430 rublogtrader.rar.su.","sameAs":["https://rublogtrader.rar.su/"]}]}</script> <link rel="alternate" type="application/rss+xml" title="Блог трейдера &raquo; Лента" href="https://rublogtrader.rar.su/feed/" /> <script type='text/javascript' src='https://rublogtrader.rar.su/wp-includes/js/jquery/jquery.min.js' id='jquery-core-js'></script> <link rel="https://api.w.org/" href="https://rublogtrader.rar.su/wp-json/" /><link rel="alternate" type="application/json" href="https://rublogtrader.rar.su/wp-json/wp/v2/posts/14341" />   <link rel="icon" type="image/png" sizes="32x32" href="/favicon32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon16.png"><link rel="apple-touch-icon" sizes="180x180" href="/appleicon.png">  <!-- Yandex.Metrika counter --><script type="text/javascript" > (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)}; m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)}) (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym"); ym(87171221, "init", { clickmap:true, trackLinks:true, accurateTrackBounce:true, webvisor:true });</script><noscript><div><img src="https://mc.yandex.ru/watch/87171221" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter --></head><body ><div id="page" class="site"><header id="masthead" class="site-header"><div class="row"><div class="col-xs-12 site-header-col"><div class="site-branding"><p class="site-title"><a href="/" rel="home">Блог трейдера</a></p></div><nav id="site-navigation" class="main-navigation"> <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">Меню</button><div class="menu-menu-container"><ul id="primary-menu" class="menu"><li id="menu-item-14443" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-14443"><a href="https://rublogtrader.rar.su/forex/">Форекс</a></li><li id="menu-item-14444" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-14444"><a href="https://rublogtrader.rar.su/trading/">Трейдинг</a></li><li id="menu-item-12561" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-12561"><a href="https://rublogtrader.rar.su/technical-analysis/">Технический анализ</a></li><li id="menu-item-12560" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-12560"><a href="https://rublogtrader.rar.su/indicators/">Индикаторы</a></li><li id="menu-item-12559" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-12559"><a href="https://rublogtrader.rar.su/prajs-jekshen/">Прайс экшен</a></li><li id="menu-item-15892" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-15892"><a href="https://rublogtrader.rar.su/investing/">Инвестиции</a></li><li id="menu-item-16239" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16239"><a href="https://rublogtrader.rar.su/crypto/">Крипто</a></li></ul></div></nav></div></div></header><div class='code-block code-block-center code-block-2 ai-viewport-1'> <a href="https://advertising-blog.qqit.ru/rublogtrader.rar.su/rublogtrader1" rel="nofollow" target="_blank"><img src="https://advertising-blog.qqit.ru/rublogtrader.rar.su/468x60.gif"/></a></div><div id="content" class="site-content"><div class="row row--index"><div class="col-xs-12"><div id="primary" class="content-area"><main id="main" class="site-main" role="main"><article id="post-14341" class="post-14341 post type-post status-publish format-standard has-post-thumbnail hentry category-mql4"><div class="row no-pad"><div class="col-xs-12 col-sm-10 col-sm-offset-1 col-md-8 col-md-offset-2 no-pad"><header class="entry-header"><h1 class="entry-title">Работа с датой и временем в MQL4: полезные функции и переменные</h1><div class="entry-meta"><a href="https://rublogtrader.rar.su/mql4/" rel="category tag">MQL4</a> | 26.06.2020 | <i class="icon-07"></i> 3086</div></header><div class="entry-content"> <img src="" style="float:right;" align="right"><p>Переменная datetime представлена ​​как количество секунд, прошедших с 1 января 1970 года. Например, 15 июня 2009 года в 0:00 будет представлено как 1245024000. Преимущество формата datetime заключается в том, что он позволяет упростить вычисления с временем и математические операции.<br> <span id="more-14341"></span><br> Например, если вы хотите проверить, наступает ли одна дата до или после другой, вы должны выполнить простую операцию. Предположим, что StartDate — 15 июня 2009 года в 14:00, а EndDate — 16 июня 2009 года в 5:00.</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1">    <span class="kw1">if</span> <span class="br0">(</span>StartDate <span class="sy0">&lt;</span> EndDate<span class="br0">)</span> <span class="co1">// Результат равен true</span>    <span class="kw1">if</span> <span class="br0">(</span>StartDate <span class="sy0">&gt;</span> EndDate<span class="br0">)</span> <span class="co1">// Результат равен false</span></pre></div></div></div></div></div></div></div><p>Другое преимущество состоит в том, что вы можете добавлять или вычитать время из определенной даты, просто добавляя или вычитая соответствующее количество секунд. Если вы хотите добавить 24 часа в StartDate, просто добавьте количество секунд:</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1">datetime AddDay <span class="sy0">=</span> StartDate <span class="sy0">+</span> <span class="nu0">86400</span><span class="sy0">;</span></pre></div></div></div></div></div></div></div><p>Если вы планируете много математических манипуляций с переменными даты и времени, было бы неплохо объявить некоторые целочисленные константы для представления определенных единиц времени:</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1"><span class="co2">#define SEC_H1 3600 // Секунды в часе </span><span class="co2">#defineSEC_D186400 // Секунды в течение дня</span></pre></div></div></div></div></div></div></div><p>Недостатком формата datetime является то, что он не очень читабелен. Вы не можете просмотреть значение, например 1245024000, и автоматически сказать, что оно представляет 15 июня 2009 г. 0:00. Для этого мы используем функции преобразования даты и времени.</p><div class="lwptoc lwptoc-autoWidth lwptoc-baseItems lwptoc-transparent lwptoc-notInherit" data-smooth-scroll="1" data-smooth-scroll-offset="24"><div class="lwptoc_i"><div class="lwptoc_items lwptoc_items-visible"><div class="lwptoc_itemWrap"><div class="lwptoc_item"> <a href="#Konstanty_daty_i_vremeni"> <span class="lwptoc_item_label">Константы даты и времени</span> </a></div><div class="lwptoc_item"> <a href="#Funkcii_dla_raboty_s_datoj_i_vremenem"> <span class="lwptoc_item_label">Функции для работы с датой и временем</span> </a></div><div class="lwptoc_item"> <a href="#Sozdanie_prostogo_tajmera"> <span class="lwptoc_item_label">Создание простого таймера</span> </a></div><div class="lwptoc_item"> <a href="#Ispolnenie_koda_na_otkrytii_bara"> <span class="lwptoc_item_label">Исполнение кода на открытии бара</span> </a></div></div></div></div></div><div class='code-block code-block-center code-block-3 ai-viewport-1'> <a href="https://advertising-blog.qqit.ru/rublogtrader.rar.su/rublogtrader2" rel="nofollow" target="_blank"><img src="https://advertising-blog.qqit.ru/rublogtrader.rar.su/pamm_landing_banner_970x250_ru_1.gif"/></a></div><h2><span id="Konstanty_daty_i_vremeni">Константы даты и времени</span></h2><p>Константа datetime — это дата и время, представленные в следующем формате: yyyy.mm.dd hh:mm. Например, 15 июня 2009 года в 0:00 будет 2009.06.15 00:00.</p><p>Чтобы преобразовать переменную datetime в строковую константу, используйте функцию TimeToStr(). Вот ее синтаксис:</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1">string TimeToStr <span class="br0">(</span>datetime Time<span class="sy0">,</span> <span class="kw4">int</span> Output <span class="sy0">=</span> TIME_DATE <span class="sy0">|</span> TIME_MINUTES<span class="br0">)</span><span class="sy0">;</span></pre></div></div></div></div></div></div></div><ul><li><strong>Time</strong> — переменная дата-время, выраженная в количестве секунд, прошедших с 1 января, 1970.</li><li><strong>Output</strong> — необязательный параметр, который выводит константу только в виде даты, часа и минуты, часа, минуты и секунды или любая другой комбинации даты и времени. Допустимые значения ввода:<p>TIME_DATE — выводит дату, например, 2009.06.15<br> TIME_MINUTES — выводит часы и минуты, например, 05:30<br> TIME_SECONDS — выводит часы, минуты и секунды, например, 05:30:45</p></li></ul><p>Чтобы вывести строковую константу в формате по умолчанию yyyy.mm.dd hh: mm, оставьте поле Output пустым. Если вам нужна только дата, либо часы и минуты (или секунды), используйте соответствующий аргумент. В этом примере мы предположим, что StartTime равен 2009.06.15 05:30:45.</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1">TimeToStr <span class="br0">(</span>StartTime<span class="sy0">,</span> TIME_DATE<span class="br0">)</span> <span class="co1">// Возвращает &quot;2009.06.15&quot;</span>TimeToStr <span class="br0">(</span>StartTime<span class="sy0">,</span> TIME_SECONDS<span class="br0">)</span> <span class="co1">// Возвращает &quot;05:30:45&quot;</span>TimeToStr <span class="br0">(</span>StartTime<span class="sy0">,</span> TIME_MINUTES<span class="br0">)</span> <span class="co1">// Возвращает &quot;05:30&quot;</span>TimeToStr <span class="br0">(</span>StartTime<span class="sy0">,</span> TIME_DATE <span class="sy0">|</span> TIME_SECONDS<span class="br0">)</span> <span class="co1">// Возвращает «2009.06.15 05:30:45»</span>TimeToStr <span class="br0">(</span>StartTime<span class="br0">)</span> <span class="co1">// Возвращает «2009.06.15 05:30»</span></pre></div></div></div></div></div></div></div><p>Мы можем создать константу даты и времени, используя конкатенацию строк, и преобразовать ее в переменную даты и времени, используя функцию StrToTime(). Синтаксис идентичен TimeToStr() выше, но без параметра Output. Строковая константа должна быть в формате yyyy.mm.dd hh: mm для правильного преобразования.</p><p>Сначала мы объявим некоторые внешние переменные для установки времени и даты:</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1"><span class="kw2">extern</span> <span class="kw4">int</span> UseMonth <span class="sy0">=</span> <span class="nu0">6</span><span class="sy0">;</span> <span class="kw2">extern</span> <span class="kw4">int</span> UseDay <span class="sy0">=</span> <span class="nu0">15</span><span class="sy0">;</span> <span class="kw2">extern</span> <span class="kw4">int</span> UseHour <span class="sy0">=</span> <span class="nu0">5</span><span class="sy0">;</span> <span class="kw2">extern</span> <span class="kw4">int</span> UseMinute <span class="sy0">=</span> <span class="nu0">30</span><span class="sy0">;</span></pre></div></div></div></div></div></div></div><p>Затем мы создаем строковую константу, используя функцию StringConcatenate(), и, наконец, преобразуем строку в формат datetime, используя StrToTime().</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1">string DateConstant <span class="sy0">=</span> StringConcatenate <span class="br0">(</span>Year <span class="br0">(</span><span class="br0">)</span><span class="sy0">,</span> <span class="st0">&quot;.&quot;</span><span class="sy0">,</span> UseMonth<span class="sy0">,</span> <span class="st0">&quot;.&quot;</span><span class="sy0">,</span> UseDay<span class="sy0">,</span> <span class="st0">&quot;&quot;</span><span class="sy0">,</span> UseHour<span class="sy0">,</span> <span class="st0">&quot;:&quot;</span><span class="sy0">,</span> UseMinute<span class="br0">)</span><span class="sy0">;</span> <span class="co1">// DateConstant равен &quot;2009.6.15 05:30&quot;</span>datetime StartTime <span class="sy0">=</span> StrToTime <span class="br0">(</span>DateConstant<span class="br0">)</span><span class="sy0">;</span> <span class="co1">// StartTime равен &quot;1245043800&quot;</span></pre></div></div></div></div></div></div></div><p>Обратите внимание, что в функции StringConcatenate() мы используем Year() для возврата текущего года вместо использования внешней переменной. Вы можете использовать такие функции, как Month(), Day() и т. д.</p><h2><span id="Funkcii_dla_raboty_s_datoj_i_vremenem">Функции для работы с датой и временем</span></h2><p>Существует две функции, которые возвращают текущее время: TimeCurrent() возвращает текущее время сервера, а TimeLocal() возвращает время вашего локального компьютера. Возможно, вы захотите создать логическую внешнюю переменную:</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1"><span class="kw2">extern</span> bool UseLocalTime <span class="sy0">=</span> <span class="kw2">true</span><span class="sy0">;</span></pre></div></div></div></div></div></div></div><p>Вот код для назначения текущего локального или текущего времени сервера переменной с именем CurrentTime.</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1"><span class="kw1">if</span> <span class="br0">(</span>UseLocalTime <span class="sy0">==</span> <span class="kw2">true</span><span class="br0">)</span> datetime CurrentTime <span class="sy0">=</span> TimeLocal <span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Местное время</span><span class="kw1">else</span> CurrentTime <span class="sy0">=</span> TimeCurrent<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Время сервера</span></pre></div></div></div></div></div></div></div><p>Иногда вам может понадобиться получить часть текущего времени, например, час или день. Вот список наиболее полезных функций, которые вы можете использовать для возврата значений текущего времени. Все эти функции используют время сервера, а не время вашего локального компьютера. Возвращаемое значение имеет тип integer:</p><ul><li>Year() — текущий год, например, 2009.</li><li>Month() — текущий месяц года от 1 по 12.</li><li>Day() — текущий день месяца с 1 по 31.</li><li>DayOfWeek() — целое число, представляющее текущий день недели. Воскресенье — 0, понедельник — 1, пятница — 5 и т. д.</li><li>Hour() — текущий час за 24 часа, с 0 до 23. Например, 3 часа ночи — 3, а 3 часа дня — 15.</li><li>Minute() — текущая минута от 0 до 59.</li></ul><p>Вы также можете получить эти значения из любой переменной datetime, используя другой набор функций. Эти функции требуют переменную datetime в качестве единственного параметра, но в остальном работают так же, как функции выше. Если вы хотите извлечь значение времени из TimeLocal(), используйте выходные данные функции TimeLocal() в качестве аргумента для следующих функций:</p><ul><li>TimeYear() — четырехзначный год указанного значения даты и времени.</li><li>TimeMonth() — месяц указанного значения даты и времени от 1 до 12.</li><li>TimeDay() — день месяца указанного значения datetime от 1 до 31.</li><li>TimeDayOfWeek() — целое число, представляющее день недели указанного значения даты и времени. Воскресенье — 0, понедельник — 1, пятница — 5 и т. д.</li><li>TimeHour() — час указанного значения даты и времени в 24-часовом времени от 0 до 23.</li><li>TimeMinute() — минута указанного значения даты и времени от 0 до 59.</li></ul><p>Вот несколько примеров использования этих функций. Предположим, что TimeLocal() равен 2009.06.15 05:30.</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1">datetime CurrentTime <span class="sy0">=</span> TimeLocal <span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>&nbsp;<span class="kw4">int</span> GetMonth <span class="sy0">=</span> TimeMonth <span class="br0">(</span>CurrentTime<span class="br0">)</span><span class="sy0">;</span> <span class="co1">// возвращает 6</span><span class="kw4">int</span> GetHour <span class="sy0">=</span> TimeHour <span class="br0">(</span>CurrentTime<span class="br0">)</span><span class="sy0">;</span> <span class="co1">// возвращает 5</span><span class="kw4">int</span> GetWeekday <span class="sy0">=</span> TimeDayOfWeek <span class="br0">(</span>CurrentTime<span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Возвращает 1 или понедельник</span></pre></div></div></div></div></div></div></div><div class='code-block code-block-center code-block-4 ai-viewport-3'> <a href="https://advertising-blog.qqit.ru/rublogtrader.rar.su/rublogtrader2" rel="nofollow" target="_blank"><img src="/b/pamm_landing_banner_300x250_ru_.gif"/></a></div><div class='code-block code-block-center code-block-8 ai-viewport-1'> <a href="https://advertising-blog.qqit.ru/rublogtrader.rar.su/rublogtrader2" rel="nofollow" target="_blank"><img src="https://advertising-blog.qqit.ru/rublogtrader.rar.su/pamm_landing_banner_970x250_ru_1.gif"/></a></div><h2><span id="Sozdanie_prostogo_tajmera">Создание простого таймера</span></h2><p>Одна очень удобная вещь, которую мы можем сделать со временем и датой в MQL, — это добавить таймер к нашему советнику. Некоторым трейдерам нравится ограничивать свою торговлю наиболее активными часами дня, такими как лондонская и нью-йоркская сессии. Другие, возможно, пожелают избежать торговли во время нестабильных рыночных событий.</p><p>Чтобы создать таймер, нам нужно указать время начала и время окончания. Мы будем использовать внешние целочисленные переменные для ввода параметров времени. Мы создадим строку с константой datetime и преобразуем ее в переменную datetime. Затем мы сравним время начала и окончания с текущим временем. Если текущее время больше времени начала, но меньше времени окончания, торговля будет разрешена.</p><p>Вот внешние переменные, которые мы будем использовать. Мы установим переменную для включения и выключения таймера, а также для выбора текущего времени (серверное или локальное). У нас есть настройки месяца, дня, часа и минуты для времени начала и окончания:</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1"><span class="kw2">extern</span> bool UseTimer <span class="sy0">=</span> <span class="kw2">true</span><span class="sy0">;</span> <span class="kw2">extern</span> bool UseLocalTime <span class="sy0">=</span> <span class="kw2">false</span><span class="sy0">;</span>&nbsp;<span class="kw2">extern</span> <span class="kw4">int</span> StartMonth <span class="sy0">=</span> <span class="nu0">6</span><span class="sy0">;</span> <span class="kw2">extern</span> <span class="kw4">int</span> StartDay <span class="sy0">=</span> <span class="nu0">15</span><span class="sy0">;</span> <span class="kw2">extern</span> <span class="kw4">int</span> StartHour <span class="sy0">=</span> <span class="nu0">7</span><span class="sy0">;</span> <span class="kw2">extern</span> <span class="kw4">int</span> StartMinute <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>&nbsp;<span class="kw2">extern</span> <span class="kw4">int</span> EndMonth <span class="sy0">=</span> <span class="nu0">6</span><span class="sy0">;</span><span class="kw2">extern</span> <span class="kw4">int</span> EndDay <span class="sy0">=</span> <span class="nu0">15</span><span class="sy0">;</span><span class="kw2">extern</span> <span class="kw4">int</span> EndHour <span class="sy0">=</span> <span class="nu0">2</span><span class="sy0">;</span><span class="kw2">extern</span> <span class="kw4">int</span> EndMinute <span class="sy0">=</span> <span class="nu0">30</span><span class="sy0">;</span></pre></div></div></div></div></div></div></div><p>Вот код для проверки. Переменная TradeAllowed определяет, открывать ли новые сделки. Если UseTimer установлено в false, TradeAllowed автоматически устанавливается в true. В противном случае мы оцениваем время начала и окончания по отношению к текущему времени, чтобы узнать, разрешим мы торговать или нет.</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1"><span class="kw1">if</span><span class="br0">(</span>UseTimer <span class="sy0">==</span> <span class="kw2">true</span><span class="br0">)</span> <span class="br0">{</span>&nbsp;<span class="co1">// Конвертируем время начала</span>string StartConstant <span class="sy0">=</span> StringConcatenate<span class="br0">(</span>Year<span class="br0">(</span><span class="br0">)</span><span class="sy0">,</span><span class="st0">&quot;.&quot;</span><span class="sy0">,</span>StartMonth<span class="sy0">,</span><span class="st0">&quot;.&quot;</span><span class="sy0">,</span>StartDay<span class="sy0">,</span><span class="st0">&quot; &quot;</span><span class="sy0">,</span>StartHour<span class="sy0">,</span><span class="st0">&quot;:&quot;</span><span class="sy0">,</span>StartMinute<span class="br0">)</span><span class="sy0">;</span>datetime StartTime <span class="sy0">=</span> StrToTime<span class="br0">(</span>StartConstant<span class="br0">)</span><span class="sy0">;</span><span class="kw1">if</span><span class="br0">(</span>StartMonth <span class="sy0">==</span> <span class="nu0">12</span> <span class="sy0">&amp;&amp;</span> StartDay <span class="sy0">==</span> <span class="nu0">31</span> <span class="sy0">&amp;&amp;</span> EndMonth <span class="sy0">==</span> <span class="nu0">1</span><span class="br0">)</span> <span class="kw4">int</span> EndYear <span class="sy0">=</span> Year<span class="br0">(</span><span class="br0">)</span> <span class="sy0">+</span> <span class="nu0">1</span><span class="sy0">;</span> <span class="kw1">else</span> EndYear <span class="sy0">=</span> Year<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>&nbsp;<span class="co1">// Конвертируем время окончания</span>string EndConstant <span class="sy0">=</span> StringConcatenate<span class="br0">(</span>EndYear<span class="sy0">,</span><span class="st0">&quot;.&quot;</span><span class="sy0">,</span>EndMonth<span class="sy0">,</span><span class="st0">&quot;.&quot;</span><span class="sy0">,</span>EndDay<span class="sy0">,</span><span class="st0">&quot; &quot;</span><span class="sy0">,</span>EndHour<span class="sy0">,</span><span class="st0">&quot;:&quot;</span><span class="sy0">,</span>EndMinute<span class="br0">)</span><span class="sy0">;</span>datetime EndTime <span class="sy0">=</span> StrToTime<span class="br0">(</span>EndConstant<span class="br0">)</span><span class="sy0">;</span>&nbsp;<span class="co1">// Выбираем локальное или серверное время</span><span class="kw1">if</span><span class="br0">(</span>UseLocalTime <span class="sy0">==</span> <span class="kw2">true</span><span class="br0">)</span> datetime CurrentTime <span class="sy0">=</span> TimeLocal<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> <span class="kw1">else</span> CurrentTime <span class="sy0">=</span> TimeCurrent<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>&nbsp;<span class="co1">// Проверяем условия торговли</span><span class="kw1">if</span><span class="br0">(</span>StartTime <span class="sy0">&lt;=</span> CurrentTime <span class="sy0">&amp;&amp;</span> EndTime <span class="sy0">&gt;</span> CurrentTime<span class="br0">)</span> <span class="br0">{</span>bool TradeAllowed <span class="sy0">=</span> <span class="kw2">true</span><span class="sy0">;</span><span class="br0">}</span><span class="kw1">else</span> TradeAllowed <span class="sy0">=</span> <span class="kw2">false</span><span class="sy0">;</span><span class="br0">}</span><span class="kw1">else</span> TradeAllowed <span class="sy0">=</span> <span class="kw2">true</span><span class="sy0">;</span></pre></div></div></div></div></div></div></div><p>Мы начинаем с преобразования нашего времени начала в переменную datetime StartTime. Оператор if (StartMonth == 12 &amp;&amp; StartDay == 31 &amp;&amp; EndMonth == 1) проверяет, является ли начальная дата последним днем года, и является ли конечный день первым первого следующего года. Если это так, он автоматически увеличивает конечный год на 1. В противном случае мы используем текущий год для EndYear.</p><p>Затем мы конвертируем время окончания в переменную datetime EndTime и выбираем, какой CurrentTime мы хотим использовать, серверный или локальный. Последний блок if проверяет, находится ли текущее время между временем начала и окончания. Если это так, TradeAllowed имеет значение true.</p><p>Теперь нам нужно добавить код для контроля исполнения сделки. Самый простой способ сделать это — добавить блок if вокруг процедуры открытия ордеров:</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1"><span class="co1">// Начало торговли</span>    <span class="kw1">if</span><span class="br0">(</span>TradeAllowed <span class="sy0">==</span> <span class="kw2">true</span><span class="br0">)</span><span class="br0">{</span>&nbsp;<span class="co1">// Ордер на покупку</span><span class="kw1">if</span><span class="br0">(</span>FastMA <span class="sy0">&gt;</span> SlowMA <span class="sy0">&amp;&amp;</span> BuyTicket <span class="sy0">==</span> <span class="nu0">0</span> <span class="sy0">&amp;&amp;</span> BuyOrderCount<span class="br0">(</span>Symbol<span class="br0">(</span><span class="br0">)</span><span class="sy0">,</span>MagicNumber<span class="br0">)</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">)</span>  <span class="br0">{</span><span class="br0">}</span>&nbsp;<span class="co1">// Ордер на продажу</span><span class="kw1">if</span><span class="br0">(</span>FastMA <span class="sy0">&lt;</span> SlowMA <span class="sy0">&amp;&amp;</span> SellTicket <span class="sy0">==</span> <span class="nu0">0</span> <span class="sy0">&amp;&amp;</span> SellOrderCount<span class="br0">(</span>Symbol<span class="br0">(</span><span class="br0">)</span><span class="sy0">,</span>MagicNumber<span class="br0">)</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">)</span>          <span class="br0">{</span>&nbsp;<span class="br0">}</span>      <span class="br0">}</span></pre></div></div></div></div></div></div></div><p>Существует много других способов создания таймеров — например, вы можете использовать день недели вместо месяца и дня или установить время торговли относительно текущего дня.</p><h2><span id="Ispolnenie_koda_na_otkrytii_bara">Исполнение кода на открытии бара</span></h2><p>По умолчанию советники работают в режиме реального времени на каждом тике. Но в некоторых случаях лучше проверять торговые условия только один раз за бар. Дождавшись закрытия текущего бара, мы можем быть уверены, что условие выполнено и торговый сигнал действителен. При совершении сделок в режиме реального времени мы можем быть более восприимчивы к ложным сигналам.</p><p>Торговля один раз за бар также означает, что результаты в тестере стратегий будут более точными и актуальными. Из-за ограничений, присущих тестеру стратегий MetaTrader, использование «каждого тика» в качестве модели тестирования приведет к ненадежным результатам бэк-тестирования из-за того, что тики часто моделируются из данных М1. Сделки, которые происходят в реальной торговле, не обязательно будут соответствовать сделкам, совершенным в тестере стратегий.</p><p>Разместив наши сделки на закрытии на баре и используя в качестве модели тестирования «Только цены открытия», мы можем получить результаты тестирования, которые более точно отражают сделки в реальном времени. Недостаток торговли один раз за бар заключается в том, что сделки могут быть выполнены более поздно, особенно если в течение бара происходит сильное движение цены.</p><p>Чтобы проверить торговые условия один раз за бар, мы должны изучить отметку времени текущего бара. Мы сохраним эту метку времени в глобальной переменной. После каждого выполнения советника мы будем сравнивать сохраненную метку времени с текущей меткой времени. Как только отметка времени текущего бара изменится, показывая, что новый бар открылся, мы проверим торговые условия.</p><p>Мы также должны отрегулировать параметр сдвига функций нашего индикатора, функции цены и массивы, чтобы вернуть значение предыдущего бара. Если функция индикатора или ценовой массив настроены на проверку текущего бара, вместо этого мы сместим индекс бара на 1, чтобы проверить предыдущий бар. Все индикаторы и ценовые массивы должны иметь свои параметры сдвига, увеличенные на 1.</p><p>Технически, мы проверяем торговые условия на первом тике нового бара, одновременно изучая значение закрытия предыдущего бара.</p><p>Вот код, чтобы проверить открытие нового бара. Сначала мы объявляем внешнюю переменную с именем CheckOncePerBar для включения и выключения этой функции. Затем мы объявляем глобальную переменную datetime для хранения метки времени текущего бара — это будет CurrentTimeStamp.</p><p>В функции init() мы назначим метку времени текущего бара для CurrentTimeStamp.</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1">&nbsp;<span class="co1">// Внешние переменные</span><span class="kw2">extern</span> bool CheckOncePerBar <span class="sy0">=</span> <span class="kw2">true</span><span class="sy0">;</span>    <span class="co1">// Глобальные переменные</span>    datetime CurrentTimeStamp<span class="sy0">;</span>    <span class="co1">// Init функция</span>    <span class="kw4">int</span> init<span class="br0">(</span><span class="br0">)</span><span class="br0">{</span>CurrentTimeStamp <span class="sy0">=</span> Time<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="sy0">;</span><span class="br0">}</span></pre></div></div></div></div></div></div></div><p>Вот код, который идет в начале нашей функции start() сразу после таймера. Целочисленная переменная BarShift будет определять, устанавливать ли значение Shift нашего индикатора и функции цены на текущий или предыдущий бар. Булевая переменная NewBar определит, будем ли мы проверять наши условия торговли:</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1"><span class="kw1">if</span><span class="br0">(</span>CheckOncePerBar <span class="sy0">==</span> <span class="kw2">true</span><span class="br0">)</span> <span class="br0">{</span><span class="kw4">int</span> BarShift <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span> <span class="kw1">if</span><span class="br0">(</span>CurrentTimeStamp <span class="sy0">!=</span> Time<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span><span class="br0">{</span>CurrentTimeStamp <span class="sy0">=</span> Time<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="sy0">;</span> bool NewBar <span class="sy0">=</span> <span class="kw2">true</span><span class="sy0">;</span><span class="br0">}</span><span class="kw1">else</span> NewBar <span class="sy0">=</span> <span class="kw2">false</span><span class="sy0">;</span><span class="br0">}</span> <span class="kw1">else</span><span class="br0">{</span>NewBar <span class="sy0">=</span> <span class="kw2">true</span><span class="sy0">;</span> BarShift <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span><span class="br0">}</span></pre></div></div></div></div></div></div></div><p>Если CheckOncePerBar установлен в true, мы сначала установим BarShift в 1. Это установит параметр Shift всех функций индикатора / цены на предыдущий бар.</p><p>Затем мы сравниваем значение переменной CurrentTimeStamp с Time [0], который является отметкой времени текущего бара. Если эти два значения не совпадают, мы присвоим значение Time [0] для CurrentTimeStamp и установим для NewBar значение true. Торговые условия будут проверены вскоре после этого.</p><p>При последующих запусках CurrentTimeStamp и Time[0] будут совпадать, что означает, что NewBar будет установлен в false. Торговые условия не будут проверяться, пока не откроется новый бар. После открытия нового бара значение Time[0] будет отличаться от значения CurrentTimeStamp, а для NewBar будет установлено значение true.</p><p>Если CheckOncePerBar установлен в false, NewBar автоматически будет установлен в true, а BarShift будет установлен в 0. Это будет проверять торговые условия на каждом тике, как и раньше.</p><p>Переменную BarShift нужно будет присвоить параметру Shift любых функций индикатора, функций цены или массивов, которые ссылаются на самый последний бар. Вот несколько примеров того, как это будет применяться:</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1"><span class="kw4">double</span> FastMA <span class="sy0">=</span> iMA<span class="br0">(</span>NULL<span class="sy0">,</span><span class="nu0">0</span><span class="sy0">,</span>FastMAPeriod<span class="sy0">,</span><span class="nu0">0</span><span class="sy0">,</span><span class="nu0">0</span><span class="sy0">,</span><span class="nu0">0</span><span class="sy0">,</span>BarShift<span class="br0">)</span><span class="sy0">;</span> <span class="kw1">if</span><span class="br0">(</span>Close<span class="br0">[</span>BarShift<span class="br0">]</span> <span class="sy0">&gt;</span> Open<span class="br0">[</span>BarShift<span class="br0">]</span><span class="br0">)</span><span class="kw4">double</span> UseLow <span class="sy0">=</span> iLow<span class="br0">(</span>NULL<span class="sy0">,</span><span class="nu0">0</span><span class="sy0">,</span>BarShift<span class="br0">)</span><span class="sy0">;</span></pre></div></div></div></div></div></div></div><p>Вместо того, чтобы проверять текущий бар, мы будем проверять только что закрытый бар, то есть предыдущий бар. Если вам нужно сослаться на бар, предшествующий последнему закрытому бару, просто добавьте текущий параметр сдвига в BarShift:</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1"><span class="kw4">double</span> LastFastMA <span class="sy0">=</span> iMA<span class="br0">(</span>NULL<span class="sy0">,</span><span class="nu0">0</span><span class="sy0">,</span>FastMAPeriod<span class="sy0">,</span><span class="nu0">0</span><span class="sy0">,</span><span class="nu0">0</span><span class="sy0">,</span><span class="nu0">0</span><span class="sy0">,</span>BarShift<span class="sy0">+</span><span class="nu0">1</span><span class="br0">)</span><span class="sy0">;</span></pre></div></div></div></div></div></div></div><p>Если вы не ожидаете когда-либо запускать свой советник один раз за бар, вам не нужно будет добавлять этот код. Но для многих торговых систем, основанных на индикаторах, это может сделать ваши результаты торговли и бэк-тестирования более надежными.</p><p>Чтобы контролировать исполнение сделок, нам нужно проверить значение NewBar перед процедурой размещения ордера. Мы можем сделать это, используя блок if, который мы поместили ранее для таймера:</p><div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="c"><pre class="de1"><span class="co1">// Начало торговли</span><span class="kw1">if</span><span class="br0">(</span>TradeAllowed <span class="sy0">==</span> <span class="kw2">true</span> <span class="sy0">&amp;&amp;</span> NewBar <span class="sy0">==</span> <span class="kw2">true</span><span class="br0">)</span> <span class="br0">{</span><span class="co1">// Ордер на покупку</span><span class="kw1">if</span><span class="br0">(</span>FastMA <span class="sy0">&gt;</span> SlowMA <span class="sy0">&amp;&amp;</span> BuyTicket <span class="sy0">==</span> <span class="nu0">0</span> <span class="sy0">&amp;&amp;</span> BuyOrderCount<span class="br0">(</span>Symbol<span class="br0">(</span><span class="br0">)</span><span class="sy0">,</span>MagicNumber<span class="br0">)</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">)</span>          <span class="br0">{</span>&nbsp;<span class="br0">}</span><span class="co1">// Ордер на продажу</span><span class="kw1">if</span><span class="br0">(</span>FastMA <span class="sy0">&lt;</span> SlowMA <span class="sy0">&amp;&amp;</span> SellTicket <span class="sy0">==</span> <span class="nu0">0</span> <span class="sy0">&amp;&amp;</span> SellOrderCount<span class="br0">(</span>Symbol<span class="br0">(</span><span class="br0">)</span><span class="sy0">,</span>MagicNumber<span class="br0">)</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">)</span>          <span class="br0">{</span>&nbsp;          <span class="br0">}</span>      <span class="br0">}</span></pre></div></div></div></div></div></div></div></div><div class='code-block code-block-center code-block-5 ai-viewport-1'> <a href="https://advertising-blog.qqit.ru/rublogtrader.rar.su/rublogtrader2" rel="nofollow" target="_blank"><img src="https://advertising-blog.qqit.ru/rublogtrader.rar.su/pamm_landing_banner_970x250_ru_1.gif"/></a></div><div class='code-block code-block-center code-block-6 ai-viewport-2 ai-viewport-3'> <a href="https://advertising-blog.qqit.ru/rublogtrader.rar.su/rublogtrader2" rel="nofollow" target="_blank"><img src="/b/pamm_landing_banner_300x250_ru_.gif"/></a></div><div class="share"> Поделиться: <a href="https://telete.in/share/url?url=https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/" target="_blank"><i class="icon-04"></i></a> <a href="http://vkontakte.ru/share.php?url=https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/" target="_blank"><i class="icon-01"></i></a> <a href="https://www.facebook.com/sharer/sharer.php?u=https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/" target="_blank"><i class="icon-09"></i></a> <a href="https://connect.ok.ru/offer?url=https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/" target="_blank"><i class="icon-02"></i></a> <a href="https://twitter.com/intent/tweet?url=https://rublogtrader.rar.su/rabota-s-datoj-i-vremenem-v-mql4/" target="_blank"><i class="icon-03"></i></a></div><div class="subsc4"> <a href="/torgovyj-algoritm-po-trejdingu-buy/">Мой торговый алгоритм по трейдингу</a></div><div class="subsc4"> <a href="/algoritm-torgovli-akcijami/">Мой алгоритм торговли акциями</a></div><div class="subsc4"> <a href="/moj-algoritm-vybora-akcij/">Мой алгоритм выбора акций по мультипликаторам</a></div><div class="subsc4"> Скачайте приложение Блог Трейдера в App Store<br><br> <a href="https://advertising-blog.qqit.ru/rublogtrader.rar.su/rublogtrader3" rel="nofollow" target="_blank"><img src="https://advertising-blog.qqit.ru/rublogtrader.rar.su/appstore.png" width="200"/></a></div><div class="title"><a href="https://rublogtrader.rar.su/mql4/" rel="category tag">MQL4</a></div><section YuzoPluginPro class="wp-yuzo yzp-wrapper  yzp-id-12792 yzp-template-list-default-l yzp-layout-list yzp-without-excerpt yzp-without-meta yzp-aspect-ratio-1-1 yzp-mobile-columns-2 yzp-tablet-columns-2 yzp-desktop-columns-2" data-version="6.2.3"  data-id="12792"  data-type="s" data-level="3" ><ul class='yzp-container' ><li class='yzp-wrap-item  esp-show-in-mobile esp-show-in-tablet esp-show-in-desktop' post-id='14353' data-n='1'><div class='yzp-item' ><div class='yzp-item-title'> <a class=''  href='https://rublogtrader.rar.su/dopolnitelnye-vozmozhnosti-mql4/'   >Дополнительные возможности MQL4 в разработке советников</a></div></div></li><li class='yzp-wrap-item  esp-show-in-mobile esp-show-in-tablet esp-show-in-desktop' post-id='10885' data-n='2'><div class='yzp-item' ><div class='yzp-item-title'> <a class=''  href='https://rublogtrader.rar.su/operatory-v-mql4/'   >Операторы в MQL4: как их использовать в программе?</a></div></div></li><li class='yzp-wrap-item  esp-show-in-mobile esp-show-in-tablet esp-show-in-desktop' post-id='11018' data-n='3'><div class='yzp-item' ><div class='yzp-item-title'> <a class=''  href='https://rublogtrader.rar.su/cena-otkrytija-zakrytija-maksimuma-i-minimuma-svechej-v-mql4/'   >Цена открытия, закрытия, максимума и минимума свечей в MQL4</a></div></div></li><li class='yzp-wrap-item  esp-show-in-mobile esp-show-in-tablet esp-show-in-desktop' post-id='11899' data-n='4'><div class='yzp-item' ><div class='yzp-item-title'> <a class=''  href='https://rublogtrader.rar.su/kak-ostanovit-torgovlju-sovetnika-esli-spred-uvelichivaetsja/'   >Как остановить торговлю советника, если спред увеличивается?</a></div></div></li><li class='yzp-wrap-item  esp-show-in-mobile esp-show-in-tablet esp-show-in-desktop' post-id='14286' data-n='5'><div class='yzp-item' ><div class='yzp-item-title'> <a class=''  href='https://rublogtrader.rar.su/programming-mql4/'   >Программирование на MQL4: основы языка и введение в синтаксис</a></div></div></li><li class='yzp-wrap-item  esp-show-in-mobile esp-show-in-tablet esp-show-in-desktop' post-id='11321' data-n='6'><div class='yzp-item' ><div class='yzp-item-title'> <a class=''  href='https://rublogtrader.rar.su/kak-poluchit-tekushhuju-cenu-torgovogo-instrumenta-s-pomoshhju-mql4/'   >Как получить текущую цену торгового инструмента с помощью MQL4?</a></div></div></li><li class='yzp-wrap-item  esp-show-in-mobile esp-show-in-tablet esp-show-in-desktop' post-id='14366' data-n='7'><div class='yzp-item' ><div class='yzp-item-title'> <a class=''  href='https://rublogtrader.rar.su/polzovatelskie-indikatory-i-skripty/'   >Пользовательские индикаторы и скрипты на MQL4: примеры кода</a></div></div></li><li class='yzp-wrap-item  esp-show-in-mobile esp-show-in-tablet esp-show-in-desktop' post-id='12812' data-n='8'><div class='yzp-item' ><div class='yzp-item-title'> <a class=''  href='https://rublogtrader.rar.su/torgovyj-sovetnik-na-mql4/'   >Торговый советник на MQL4: учимся программировать с нуля</a></div></div></li><li class='yzp-wrap-item  esp-show-in-mobile esp-show-in-tablet esp-show-in-desktop' post-id='11089' data-n='9'><div class='yzp-item' ><div class='yzp-item-title'> <a class=''  href='https://rublogtrader.rar.su/kak-opredelit-peresechenie-linij-dvuh-indikatorov-na-mql4/'   >Как определить пересечение линий двух индикаторов на MQL4?</a></div></div></li><li class='yzp-wrap-item  esp-show-in-mobile esp-show-in-tablet esp-show-in-desktop' post-id='11369' data-n='10'><div class='yzp-item' ><div class='yzp-item-title'> <a class=''  href='https://rublogtrader.rar.su/kak-izmenjat-otkrytye-i-otlozhennye-ordera-v-mql4/'   >Как изменять открытые и отложенные ордера в MQL4?</a></div></div></li></ul></section></div></div></article><div class="col-xs-12 col-sm-10 col-sm-offset-1 col-md-8 col-md-offset-2 no-pad"><div id="comments" class="comments-area"><div id="respond" class="comment-respond"> <span id="reply-title" class="h4 comment-reply-title">Добавить комментарий <small><a rel="nofollow" id="cancel-comment-reply-link" href="/rabota-s-datoj-i-vremenem-v-mql4/#respond" style="display:none;">Отменить ответ</a></small></span><form action="https://rublogtrader.rar.su/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Ваш адрес email не будет опубликован.</span></p><p class="comment-form-comment"><label for="comment">Комментарий</label><textarea style="display:none;" id="comment" name="comment" cols="45" rows="8" maxlength="65525" ></textarea><textarea id="real-comment" name="real-comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Имя</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Отправить комментарий" /> <input type='hidden' name='comment_post_ID' value='14341' id='comment_post_ID' /> <input type='hidden' name='comment_parent' id='comment_parent' value='0' /></p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="64fc9371d3" /></p><p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js" name="ak_js" value="211"/><script>document.getElementById( "ak_js" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form></div></div></div></main></div></div></div></div><div class="spu-bg" id="spu-bg-16205"></div><div class="spu-box  spu-centered spu-total- " id="spu-16205" data-box-id="16205" data-trigger="seconds" data-trigger-number="5" data-spuanimation="fade" data-tconvert-cookie="d" data-tclose-cookie="d" data-dconvert-cookie="999" data-dclose-cookie="30" data-nconvert-cookie="spu_conversion_16205" data-nclose-cookie="spu_closing_16205" data-test-mode="0" data-auto-hide="0" data-close-on-conversion="1" data-bgopa="0.5" data-total="" style="left:-99999px !important;right:auto;" data-width="600" ><div class="spu-content"><p><a href="https://www.instaglobe.net/ru/pamm_trading?x=trdblogpam&#038;utm_source=tradeblog.net&#038;utm_campaign=pamm" target="_blank" rel="noopener"><img src="https://rublogtrader.rar.su/wp-content/uploads/2021/12/700_400_Popup.jpg" alt="" width="700" height="400" class="alignnone size-full wp-image-16207" /></a></p></div> <span class="spu-close spu-close-popup top_right"><i class="spu-icon spu-icon-close"></i></span> <span class="spu-timer"></span></div><div id="fb-root" class=" fb_reset"></div><div id="shiftnav-toggle-main" class="shiftnav-toggle-main-align-center shiftnav-toggle-style-full_bar shiftnav-togglebar-gap-on shiftnav-toggle-edge-left shiftnav-toggle-icon-bars shiftnav--hide-scroll-down"   ><button id="shiftnav-toggle-main-button" class="shiftnav-toggle shiftnav-toggle-shiftnav-main shiftnav-toggle-burger" tabindex="1" data-shiftnav-target="shiftnav-main" aria-label="Toggle Menu"><i class="fa fa-bars"></i></button><div class="shiftnav-main-toggle-content shiftnav-toggle-main-block"><a href="https://rublogtrader.rar.su">Блог трейдера</a></div><div class="shiftnav-main-toggle-content-after"> <a class="shiftnav-searchbar-toggle  shiftnav-toggle-main-block shiftnav-toggle-main-ontop" tabindex="1"><i class="fa fa-search"></i></a><div class="shiftnav-searchbar-drop"><form role="search" method="get" class="shiftnav-searchform" action="https://rublogtrader.rar.su/"> <input type="text" placeholder="Search..." value="" name="s" class="shiftnav-search-input" /> <input type="submit" class="shiftnav-search-submit" value="&#xf002;" /></form></div></div></div><div class="shiftnav shiftnav-nojs shiftnav-shiftnav-main shiftnav-left-edge shiftnav-skin-none shiftnav-transition-standard" id="shiftnav-main" data-shiftnav-id="shiftnav-main"><div class="shiftnav-inner"><nav class="shiftnav-nav"><ul id="menu-menu-2" class="shiftnav-menu shiftnav-targets-default shiftnav-targets-text-default shiftnav-targets-icon-default"><li id="menu-item-14441" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-14441 shiftnav-depth-0"><a class="shiftnav-target"  href="https://rublogtrader.rar.su/forex/">Форекс</a></li><li id="menu-item-14442" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-14442 shiftnav-depth-0"><a class="shiftnav-target"  href="https://rublogtrader.rar.su/trading/">Трейдинг</a></li><li id="menu-item-10795" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10795 shiftnav-depth-0"><a class="shiftnav-target"  href="https://rublogtrader.rar.su/technical-analysis/">Технический анализ</a></li><li id="menu-item-10797" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10797 shiftnav-depth-0"><a class="shiftnav-target"  href="https://rublogtrader.rar.su/indicators/">Индикаторы</a></li><li id="menu-item-10798" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10798 shiftnav-depth-0"><a class="shiftnav-target"  href="https://rublogtrader.rar.su/prajs-jekshen/">Прайс экшен</a></li><li id="menu-item-16043" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16043 shiftnav-depth-0"><a class="shiftnav-target"  href="https://rublogtrader.rar.su/investing/">Инвестиции</a></li><li id="menu-item-16238" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16238 shiftnav-depth-0"><a class="shiftnav-target"  href="https://rublogtrader.rar.su/crypto/">Крипто</a></li></ul></nav> <button class="shiftnav-sr-close shiftnav-sr-only shiftnav-sr-only-focusable"> &times; Close Panel </button></div></div><div style="display: none;" id="nxsFavNotice"><div id="nxsFavNoticeCnt">Posting....</div></div><div id="wpfront-scroll-top-container"> <img src="https://rublogtrader.rar.su/wp-content/uploads/2019/03/scroll-3.png" alt="" /></div> <script type="text/javascript">function wpfront_scroll_top_init() {                if (typeof wpfront_scroll_top === "function" && typeof jQuery !== "undefined") {                    wpfront_scroll_top({"scroll_offset":3000,"button_width":60,"button_height":60,"button_opacity":0.9,"button_fade_duration":200,"scroll_duration":400,"location":1,"marginX":250,"marginY":20,"hide_iframe":false,"auto_hide":false,"auto_hide_after":2,"button_action":"top","button_action_element_selector":"","button_action_container_selector":"html, body","button_action_element_offset":0});                } else {                    setTimeout(wpfront_scroll_top_init, 100);                }            }            wpfront_scroll_top_init();</script> <script type='text/javascript' id='yuzo-js-js-extra'>var yuzo_vars = {"ajaxurl":"https:\/\/rublogtrader.rar.su\/wp-admin\/admin-ajax.php","post_id":"14341","url":"https%3A%2F%2Frublogtrader.rar.su%2Frabota-s-datoj-i-vremenem-v-mql4%2F","where_is":"single|singular","nonce":"7e9956422c","nonce2":"98ebd05f15","off_views":"0","off_views_logged":"1","is_logged":"0","allows_to_count_visits":"1","disabled_counter":"0","level_article":"medium"};</script> <script type='text/javascript' id='spu-public-js-extra'>var spuvar = {"is_admin":"","disable_style":"","ajax_mode":"","ajax_url":"https:\/\/rublogtrader.rar.su\/wp-admin\/admin-ajax.php","ajax_mode_url":"https:\/\/rublogtrader.rar.su\/?spu_action=spu_load","pid":"14341","is_front_page":"","is_category":"","site_url":"https:\/\/rublogtrader.rar.su","is_archive":"","is_search":"","is_preview":"","seconds_confirmation_close":"5"};var spuvar_social = [];</script> <script type='text/javascript' id='shiftnav-js-extra'>var shiftnav_data = {"shift_body":"off","shift_body_wrapper":"","lock_body":"on","lock_body_x":"off","open_current":"off","collapse_accordions":"off","scroll_panel":"off","breakpoint":"1120","v":"1.7.0.1","pro":"1","touch_off_close":"on","scroll_offset":"100","disable_transforms":"off","close_on_target_click":"off","scroll_top_boundary":"50","process_uber_segments":"on"};</script> <script>ai_front = {"insertion_before":"BEFORE","insertion_after":"AFTER","insertion_prepend":"PREPEND CONTENT","insertion_append":"APPEND CONTENT","insertion_replace_content":"REPLACE CONTENT","insertion_replace_element":"REPLACE ELEMENT","visible":"VISIBLE","hidden":"HIDDEN","fallback":"FALLBACK","automatically_placed":"Automatically placed by AdSense Auto ads code","cancel":"Cancel","use":"Use","add":"Add","parent":"Parent","cancel_element_selection":"Cancel element selection","select_parent_element":"Select parent element","css_selector":"CSS selector","use_current_selector":"Use current selector","element":"ELEMENT","path":"PATH","selector":"SELECTOR"};function b2a(a){var b,c=0,l=0,f="",g=[];if(!a)return a;do{var e=a.charCodeAt(c++);var h=a.charCodeAt(c++);var k=a.charCodeAt(c++);var d=e<<16|h<<8|k;e=63&d>>18;h=63&d>>12;k=63&d>>6;d&=63;g[l++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(k)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)}while(c<a.length);return f=g.join(""),b=a.length%3,(b?f.slice(0,b-3):f)+"===".slice(b||3)}function a2b(a){var b,c,l,f={},g=0,e=0,h="",k=String.fromCharCode,d=a.length;for(b=0;64>b;b++)f["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(b)]=b;for(c=0;d>c;c++)for(b=f[a.charAt(c)],g=(g<<6)+b,e+=6;8<=e;)((l=255&g>>>(e-=8))||d-2>c)&&(h+=k(l));return h}b64e=function(a){return btoa(encodeURIComponent(a).replace(/%([0-9A-F]{2})/g,function(b,a){return String.fromCharCode("0x"+a)}))};b64d=function(a){return decodeURIComponent(atob(a).split("").map(function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join(""))};(function(a){if("function"===typeof define&&define.amd){define(a);var c=!0}"object"===typeof exports&&(module.exports=a(),c=!0);if(!c){var d=window.Cookies,b=window.Cookies=a();b.noConflict=function(){window.Cookies=d;return b}}})(function(){function a(){for(var d=0,b={};d<arguments.length;d++){var f=arguments[d],e;for(e in f)b[e]=f[e]}return b}function c(d){function b(){}function f(h,k,g){if("undefined"!==typeof document){g=a({path:"/"},b.defaults,g);"number"===typeof g.expires&&(g.expires=new Date(1*new Date+864E5*g.expires));g.expires=g.expires?g.expires.toUTCString():"";try{var l=JSON.stringify(k);/^[\{\[]/.test(l)&&(k=l)}catch(p){}k=d.write?d.write(k,h):encodeURIComponent(String(k)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent);h=encodeURIComponent(String(h)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);l="";for(var n in g)g[n]&&(l+="; "+n,!0!==g[n]&&(l+="="+g[n].split(";")[0]));return document.cookie=h+"="+k+l}}function e(h,k){if("undefined"!==typeof document){for(var g={},l=document.cookie?document.cookie.split("; "):[],n=0;n<l.length;n++){var p=l[n].split("="),m=p.slice(1).join("=");k||'"'!==m.charAt(0)||(m=m.slice(1,-1));try{var q=p[0].replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent);m=(d.read||d)(m,q)||m.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent);if(k)try{m=JSON.parse(m)}catch(r){}g[q]=m;if(h===q)break}catch(r){}}return h?g[h]:g}}b.set=f;b.get=function(h){return e(h,!1)};b.getJSON=function(h){return e(h,!0)};b.remove=function(h,k){f(h,"",a(k,{expires:-1}))};b.defaults={};b.withConverter=c;return b}return c(function(){})});AiCookies=Cookies.noConflict();ai_check_block=function(a){if(null==a)return!0;var c=AiCookies.getJSON("aiBLOCKS");ai_debug_cookie_status="";null==c&&(c={});"undefined"!==typeof ai_delay_showing_pageviews&&(c.hasOwnProperty(a)||(c[a]={}),c[a].hasOwnProperty("d")||(c[a].d=ai_delay_showing_pageviews));if(c.hasOwnProperty(a))for(var d in c[a]){if("x"==d){var b="",f=document.querySelectorAll('span[data-ai-block="'+a+'"]')[0];"aiHash"in f.dataset&&(b=f.dataset.aiHash);f="";c[a].hasOwnProperty("h")&&(f=c[a].h);var e=new Date;e=c[a][d]-Math.round(e.getTime()/1E3);if(0<e&&f==b)return ai_debug_cookie_status=a="closed for "+e+" s = "+Math.round(1E4*e/3600/24)/1E4+" days",!1;ai_set_cookie(a,"x","");c[a].hasOwnProperty("i")||c[a].hasOwnProperty("c")||ai_set_cookie(a,"h","")}else if("d"==d){if(0!=c[a][d])return ai_debug_cookie_status=a="delayed for "+c[a][d]+" pageviews",!1}else if("i"==d){b="";f=document.querySelectorAll('span[data-ai-block="'+a+'"]')[0];"aiHash"in f.dataset&&(b=f.dataset.aiHash);f="";c[a].hasOwnProperty("h")&&(f=c[a].h);if(0==c[a][d]&&f==b)return ai_debug_cookie_status=a="max impressions reached",!1;if(0>c[a][d]&&f==b){e=new Date;e=-c[a][d]-Math.round(e.getTime()/1E3);if(0<e)return ai_debug_cookie_status=a="max imp. reached ("+Math.round(1E4*e/24/3600)/1E4+" days = "+e+" s)",!1;ai_set_cookie(a,"i","");c[a].hasOwnProperty("c")||c[a].hasOwnProperty("x")||ai_set_cookie(a,"h","")}}if("ipt"==d&&0==c[a][d]&&(e=new Date,b=Math.round(e.getTime()/1E3),e=c[a].it-b,0<e))return ai_debug_cookie_status=a="max imp. per time reached ("+Math.round(1E4*e/24/3600)/1E4+" days = "+e+" s)",!1;if("c"==d){b="";f=document.querySelectorAll('span[data-ai-block="'+a+'"]')[0];"aiHash"in f.dataset&&(b=f.dataset.aiHash);f="";c[a].hasOwnProperty("h")&&(f=c[a].h);if(0==c[a][d]&&f==b)return ai_debug_cookie_status=a="max clicks reached",!1;if(0>c[a][d]&&f==b){e=new Date;e=-c[a][d]-Math.round(e.getTime()/1E3);if(0<e)return ai_debug_cookie_status=a="max clicks reached ("+Math.round(1E4*e/24/3600)/1E4+" days = "+e+" s)",!1;ai_set_cookie(a,"c","");c[a].hasOwnProperty("i")||c[a].hasOwnProperty("x")||ai_set_cookie(a,"h","")}}if("cpt"==d&&0==c[a][d]&&(e=new Date,b=Math.round(e.getTime()/1E3),e=c[a].ct-b,0<e))return ai_debug_cookie_status=a="max clicks per time reached ("+Math.round(1E4*e/24/3600)/1E4+" days = "+e+" s)",!1}ai_debug_cookie_status="OK";return!0};ai_check_and_insert_block=function(a,c){if(null==a)return!0;var d=document.getElementsByClassName(c);if(d.length){d=d[0];var b=d.closest(".code-block");if(ai_check_block(a)){if(ai_insert_code(d),b){var f=b.querySelectorAll(".ai-debug-block");b&&f.length&&(b.classList.remove("ai-list-block"),b.classList.remove("ai-list-block-ip"),b.style.visibility="",b.classList.contains("ai-remove-position")&&(b.style.position=""))}}else{f=d.closest("div[data-ai]");if(null!=f&&"undefined"!=typeof f.getAttribute("data-ai")){var e=JSON.parse(b64d(f.getAttribute("data-ai")));"undefined"!==typeof e&&e.constructor===Array&&(e[1]="",f.setAttribute("data-ai",b64e(JSON.stringify(e))))}f=b.querySelectorAll(".ai-debug-block");b&&f.length&&(b.classList.remove("ai-list-block"),b.classList.remove("ai-list-block-ip"),b.style.visibility="",b.classList.contains("ai-remove-position")&&(b.style.position=""))}d.classList.remove(c)}d=document.querySelectorAll("."+c+"-dbg");b=0;for(f=d.length;b<f;b++)e=d[b],e.querySelector(".ai-status").textContent=ai_debug_cookie_status,e.querySelector(".ai-cookie-data").textContent=ai_get_cookie_text(a),e.classList.remove(c+"-dbg")};function ai_load_cookie(){var a=AiCookies.getJSON("aiBLOCKS");null==a&&(a={});return a}function ai_get_cookie(a,c){var d="",b=ai_load_cookie();b.hasOwnProperty(a)&&b[a].hasOwnProperty(c)&&(d=b[a][c]);return d}function ai_set_cookie(a,c,d){var b=ai_load_cookie();if(""===d){if(b.hasOwnProperty(a)){delete b[a][c];a:{c=b[a];for(f in c)if(c.hasOwnProperty(f)){var f=!1;break a}f=!0}f&&delete b[a]}}else b.hasOwnProperty(a)||(b[a]={}),b[a][c]=d;0===Object.keys(b).length&&b.constructor===Object?AiCookies.remove("aiBLOCKS"):AiCookies.set("aiBLOCKS",b,{expires:365,path:"/"});return b}ai_get_cookie_text=function(a){var c=AiCookies.getJSON("aiBLOCKS");null==c&&(c={});return c.hasOwnProperty(a)?JSON.stringify(c[a]).replace(/"/g,"").replace("{","").replace("}",""):""};ai_insert=function(d,l,v){for(var p=-1!=l.indexOf(":eq")?jQuery(l):document.querySelectorAll(l),t=0,y=p.length;t<y;t++){var b=p[t];selector_string=b.hasAttribute("id")?"#"+b.getAttribute("id"):b.hasAttribute("class")?"."+b.getAttribute("class").replace(RegExp(" ","g"),"."):"";var u=document.createElement("div");u.innerHTML=v;var m=u.getElementsByClassName("ai-selector-counter")[0];null!=m&&(m.innerText=t+1);m=u.getElementsByClassName("ai-debug-name ai-main")[0];if(null!=m){var k="";"before"==d?k=ai_front.insertion_before:"after"==d?k=ai_front.insertion_after:"prepend"==d?k=ai_front.insertion_prepend:"append"==d?k=ai_front.insertion_append:"replace-content"==d?k=ai_front.insertion_replace_content:"replace-element"==d&&(k=ai_front.insertion_replace_element);-1==selector_string.indexOf(".ai-viewports")&&(m.innerText=k+" "+l+" ("+b.tagName.toLowerCase()+selector_string+")")}m=document.createRange();k=!0;try{var w=m.createContextualFragment(u.innerHTML)}catch(r){k=!1}"before"==d?k?b.parentNode.insertBefore(w,b):jQuery(u.innerHTML).insertBefore(jQuery(b)):"after"==d?k?b.parentNode.insertBefore(w,b.nextSibling):jQuery(u.innerHTML).insertBefore(jQuery(b.nextSibling)):"prepend"==d?k?b.insertBefore(w,b.firstChild):jQuery(u.innerHTML).insertBefore(jQuery(b.firstChild)):"append"==d?k?b.insertBefore(w,null):jQuery(u.innerHTML).appendTo(jQuery(b)):"replace-content"==d?(b.innerHTML="",k?b.insertBefore(w,null):jQuery(u.innerHTML).appendTo(jQuery(b))):"replace-element"==d&&(k?b.parentNode.insertBefore(w,b):jQuery(u.innerHTML).insertBefore(jQuery(b)),b.parentNode.removeChild(b))}};ai_insert_code=function(d){function l(m,k){return null==m?!1:m.classList?m.classList.contains(k):-1<(" "+m.className+" ").indexOf(" "+k+" ")}function v(m,k){null!=m&&(m.classList?m.classList.add(k):m.className+=" "+k)}function p(m,k){null!=m&&(m.classList?m.classList.remove(k):m.className=m.className.replace(new RegExp("(^|\\b)"+k.split(" ").join("|")+"(\\b|$)","gi")," "))}if("undefined"!=typeof d){var t=!1;if(l(d,"no-visibility-check")||d.offsetWidth||d.offsetHeight||d.getClientRects().length){t=d.getAttribute("data-code");var y=d.getAttribute("data-insertion"),b=d.getAttribute("data-selector");if(null!=t)if(null!=y&&null!=b){if(-1!=b.indexOf(":eq")?jQuery(b).length:document.querySelectorAll(b).length)ai_insert(y,b,b64d(t)),p(d,"ai-viewports")}else{y=document.createRange();b=!0;try{var u=y.createContextualFragment(b64d(t))}catch(m){b=!1}b?d.parentNode.insertBefore(u,d.nextSibling):jQuery(b64d(t)).insertBefore(jQuery(d.nextSibling));p(d,"ai-viewports")}t=!0}else u=d.previousElementSibling,l(u,"ai-debug-bar")&&l(u,"ai-debug-script")&&(p(u,"ai-debug-script"),v(u,"ai-debug-viewport-invisible")),p(d,"ai-viewports");return t}};ai_insert_list_code=function(d){var l=document.getElementsByClassName(d)[0];if("undefined"!=typeof l){var v=ai_insert_code(l),p=l.closest("div.code-block");if(p){v||p.removeAttribute("data-ai");var t=p.querySelectorAll(".ai-debug-block");p&&t.length&&(p.classList.remove("ai-list-block"),p.classList.remove("ai-list-block-ip"),p.style.visibility="",p.classList.contains("ai-remove-position")&&(p.style.position=""))}l.classList.remove(d);v&&ai_process_elements()}};ai_insert_viewport_code=function(d){var l=document.getElementsByClassName(d)[0];"undefined"!=typeof l&&(ai_insert_code(l),l.classList.remove(d),ai_process_elements())};ai_insert_code_by_class=function(d){var l=document.getElementsByClassName(d)[0];"undefined"!=typeof l&&(ai_insert_code(l),l.classList.remove(d))};ai_insert_client_code=function(d,l){var v=document.getElementsByClassName(d)[0];if("undefined"!=typeof v){var p=v.getAttribute("data-code");null!=p&&ai_check_block()&&ai_check_and_insert_block()&&(v.setAttribute("data-code",p.substring(Math.floor(l/19))),ai_insert_code_by_class(d),v.remove())}};ai_process_elements_active=!1;function ai_process_elements(){ai_process_elements_active||setTimeout(function(){ai_process_elements_active=!1;"function"==typeof ai_process_rotations&&ai_process_rotations();"function"==typeof ai_process_lists&&ai_process_lists(jQuery(".ai-list-data"));"function"==typeof ai_process_ip_addresses&&ai_process_ip_addresses(jQuery(".ai-ip-data"));"function"==typeof ai_adb_process_blocks&&ai_adb_process_blocks()},5);ai_process_elements_active=!0}var Arrive=function(d,l,v){function p(r,c,e){b.addMethod(c,e,r.unbindEvent);b.addMethod(c,e,r.unbindEventWithSelectorOrCallback);b.addMethod(c,e,r.unbindEventWithSelectorAndCallback)}function t(r){r.arrive=k.bindEvent;p(k,r,"unbindArrive");r.leave=w.bindEvent;p(w,r,"unbindLeave")}if(d.MutationObserver&&"undefined"!==typeof HTMLElement){var y=0,b=function(){var r=HTMLElement.prototype.matches||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector;return{matchesSelector:function(c,e){return c instanceof HTMLElement&&r.call(c,e)},addMethod:function(c,e,f){var a=c[e];c[e]=function(){if(f.length==arguments.length)return f.apply(this,arguments);if("function"==typeof a)return a.apply(this,arguments)}},callCallbacks:function(c,e){e&&e.options.onceOnly&&1==e.firedElems.length&&(c=[c[0]]);for(var f=0,a;a=c[f];f++)a&&a.callback&&a.callback.call(a.elem,a.elem);e&&e.options.onceOnly&&1==e.firedElems.length&&e.me.unbindEventWithSelectorAndCallback.call(e.target,e.selector,e.callback)},checkChildNodesRecursively:function(c,e,f,a){for(var g=0,h;h=c[g];g++)f(h,e,a)&&a.push({callback:e.callback,elem:h}),0<h.childNodes.length&&b.checkChildNodesRecursively(h.childNodes,e,f,a)},mergeArrays:function(c,e){var f={},a;for(a in c)c.hasOwnProperty(a)&&(f[a]=c[a]);for(a in e)e.hasOwnProperty(a)&&(f[a]=e[a]);return f},toElementsArray:function(c){"undefined"===typeof c||"number"===typeof c.length&&c!==d||(c=[c]);return c}}}(),u=function(){var r=function(){this._eventsBucket=[];this._beforeRemoving=this._beforeAdding=null};r.prototype.addEvent=function(c,e,f,a){c={target:c,selector:e,options:f,callback:a,firedElems:[]};this._beforeAdding&&this._beforeAdding(c);this._eventsBucket.push(c);return c};r.prototype.removeEvent=function(c){for(var e=this._eventsBucket.length-1,f;f=this._eventsBucket[e];e--)c(f)&&(this._beforeRemoving&&this._beforeRemoving(f),(f=this._eventsBucket.splice(e,1))&&f.length&&(f[0].callback=null))};r.prototype.beforeAdding=function(c){this._beforeAdding=c};r.prototype.beforeRemoving=function(c){this._beforeRemoving=c};return r}(),m=function(r,c){var e=new u,f=this,a={fireOnAttributesModification:!1};e.beforeAdding(function(g){var h=g.target;if(h===d.document||h===d)h=document.getElementsByTagName("html")[0];var n=new MutationObserver(function(x){c.call(this,x,g)});var q=r(g.options);n.observe(h,q);g.observer=n;g.me=f});e.beforeRemoving(function(g){g.observer.disconnect()});this.bindEvent=function(g,h,n){h=b.mergeArrays(a,h);for(var q=b.toElementsArray(this),x=0;x<q.length;x++)e.addEvent(q[x],g,h,n)};this.unbindEvent=function(){var g=b.toElementsArray(this);e.removeEvent(function(h){for(var n=0;n<g.length;n++)if(this===v||h.target===g[n])return!0;return!1})};this.unbindEventWithSelectorOrCallback=function(g){var h=b.toElementsArray(this);e.removeEvent("function"===typeof g?function(n){for(var q=0;q<h.length;q++)if((this===v||n.target===h[q])&&n.callback===g)return!0;return!1}:function(n){for(var q=0;q<h.length;q++)if((this===v||n.target===h[q])&&n.selector===g)return!0;return!1})};this.unbindEventWithSelectorAndCallback=function(g,h){var n=b.toElementsArray(this);e.removeEvent(function(q){for(var x=0;x<n.length;x++)if((this===v||q.target===n[x])&&q.selector===g&&q.callback===h)return!0;return!1})};return this},k=new function(){function r(f,a,g){return b.matchesSelector(f,a.selector)&&(f._id===v&&(f._id=y++),-1==a.firedElems.indexOf(f._id))?(a.firedElems.push(f._id),!0):!1}var c={fireOnAttributesModification:!1,onceOnly:!1,existing:!1};k=new m(function(f){var a={attributes:!1,childList:!0,subtree:!0};f.fireOnAttributesModification&&(a.attributes=!0);return a},function(f,a){f.forEach(function(g){var h=g.addedNodes,n=g.target,q=[];null!==h&&0<h.length?b.checkChildNodesRecursively(h,a,r,q):"attributes"===g.type&&r(n,a,q)&&q.push({callback:a.callback,elem:n});b.callCallbacks(q,a)})});var e=k.bindEvent;k.bindEvent=function(f,a,g){"undefined"===typeof g?(g=a,a=c):a=b.mergeArrays(c,a);var h=b.toElementsArray(this);if(a.existing){for(var n=[],q=0;q<h.length;q++)for(var x=h[q].querySelectorAll(f),z=0;z<x.length;z++)n.push({callback:g,elem:x[z]});if(a.onceOnly&&n.length)return g.call(n[0].elem,n[0].elem);setTimeout(b.callCallbacks,1,n)}e.call(this,f,a,g)};return k},w=new function(){function r(f,a){return b.matchesSelector(f,a.selector)}var c={};w=new m(function(){return{childList:!0,subtree:!0}},function(f,a){f.forEach(function(g){g=g.removedNodes;var h=[];null!==g&&0<g.length&&b.checkChildNodesRecursively(g,a,r,h);b.callCallbacks(h,a)})});var e=w.bindEvent;w.bindEvent=function(f,a,g){"undefined"===typeof g?(g=a,a=c):a=b.mergeArrays(c,a);e.call(this,f,a,g)};return w};l&&t(l.fn);t(HTMLElement.prototype);t(NodeList.prototype);t(HTMLCollection.prototype);t(HTMLDocument.prototype);t(Window.prototype);l={};p(k,l,"unbindAllArrive");p(w,l,"unbindAllLeave");return l}}(window,"undefined"===typeof jQuery?null:jQuery,void 0);var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,k){a.raw=k;return a};$jscomp.arrayIteratorImpl=function(a){var k=0;return function(){return k<a.length?{done:!1,value:a[k++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var k="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return k?k.call(a):$jscomp.arrayIterator(a)};jQuery(function(a){function k(e){e=e.match(E);return null!=e&&1<e.length&&"string"===typeof e[1]&&0<e[1].length?e[1].toLowerCase():null}function z(e){try{var h=Date.parse(e);isNaN(h)&&(h=null)}catch(J){h=null}if(null==h&&e.includes(" ")){e=e.split(" ");try{h=Date.parse(e[0]);if(e[1].includes(":")){var F=e[1].split(":");h+=1E3*(3600*parseInt(F[0])+60*parseInt(F[1])+parseInt(F[2]))}isNaN(h)&&(h=null)}catch(J){h=null}}return h}function n(){(jQuery("#ai-iab-tcf-bar").length||jQuery(".ai-list-manual").length)&&"function"==typeof __tcfapi&&"function"==typeof ai_load_blocks&&"undefined"==typeof ai_iab_tcf_callback_installed&&(__tcfapi("addEventListener",2,function(e,h){h&&"useractioncomplete"===e.eventStatus&&(ai_tcData=e,ai_load_blocks(),jQuery("#ai-iab-tcf-status").text("DATA LOADED"),jQuery("#ai-iab-tcf-bar").addClass("status-ok").removeClass("status-error"))}),ai_iab_tcf_callback_installed=!0)}Array.prototype.includes||(Array.prototype.includes=function(e){return!!~this.indexOf(e)});var E=/:\/\/(.[^/:]+)/i;ai_process_lists=function(e){function h(d,b,g){if(0==d.length){if("!@!"==g)return!0;b!=g&&("true"==g.toLowerCase()?g=!0:"false"==g.toLowerCase()&&(g=!1));return b==g}if("object"!=typeof b&&"array"!=typeof b)return!1;var f=d[0];d=d.slice(1);if("*"==f)for(b=$jscomp.makeIterator(Object.entries(b)),f=b.next();!f.done;f=b.next()){if(f=$jscomp.makeIterator(f.value),f.next(),f=f.next().value,h(d,f,g))return!0}else if(f in b)return h(d,b[f],g);return!1}function F(d,b,g){if("object"!=typeof d||-1==b.indexOf("["))return!1;b=b.replace(/]| /gi,"").split("[");return h(b,d,g)}function J(){"function"==typeof __tcfapi&&(a("#ai-iab-tcf-status").text("DETECTED"),__tcfapi("getTCData",2,function(d,b){b?(a("#ai-iab-tcf-bar").addClass("status-ok"),"tcloaded"==d.eventStatus||"useractioncomplete"==d.eventStatus?(ai_tcData=d,d.gdprApplies?a("#ai-iab-tcf-status").text("DATA LOADED"):jQuery("#ai-iab-tcf-status").text("GDPR DOES NOT APPLY"),a("#ai-iab-tcf-bar").addClass("status-ok").removeClass("status-error"),setTimeout(function(){ai_process_lists()},10)):"cmpuishown"==d.eventStatus&&(ai_cmpuishown=!0,a("#ai-iab-tcf-status").text("CMP UI SHOWN"),a("#ai-iab-tcf-bar").addClass("status-ok").removeClass("status-error"))):(a("#ai-iab-tcf-status").text("__tcfapi getTCData failed"),a("#ai-iab-tcf-bar").removeClass("status-ok").addClass("status-error"))}))}function P(d){"function"==typeof __tcfapi?("undefined"==typeof ai_iab_tcf_callback_installed&&n(),"undefined"==typeof ai_tcData_requested&&(ai_tcData_requested=!0,J(),url_parameters_need_tcData=!0)):d&&(a("#ai-iab-tcf-bar").addClass("status-error").removeClass("status-ok"),a("#ai-iab-tcf-status").text("MISSING: __tcfapi function not found"))}e=null==e?a("div.ai-list-data, meta.ai-list-data"):e.filter(".ai-list-data");if(e.length){e.removeClass("ai-list-data");var G=document.cookie.split(";");G.forEach(function(d,b){G[b]=d.trim()});var Q=getAllUrlParams(window.location.search);if(null!=Q.referrer)var r=Q.referrer;else r=document.referrer,""!=r&&(r=k(r));var K=window.navigator.userAgent,L=K.toLowerCase();if("undefined"!==typeof MobileDetect)var R=new MobileDetect(K);e.each(function(){var d=a(this).closest("div.code-block"),b=!0,g=a(this).attr("referer-list");if("undefined"!=typeof g){g=b64d(g).split(",");var f=a(this).attr("referer-list-type"),l=!1;a.each(g,function(t,c){if(""==c)return!0;if("*"==c.charAt(0))if("*"==c.charAt(c.length-1)){if(c=c.substr(1,c.length-2),-1!=r.indexOf(c))return l=!0,!1}else{if(c=c.substr(1),r.substr(-c.length)==c)return l=!0,!1}else if("*"==c.charAt(c.length-1)){if(c=c.substr(0,c.length-1),0==r.indexOf(c))return l=!0,!1}else if("#"==c){if(""==r)return l=!0,!1}else if(c==r)return l=!0,!1});switch(f){case "B":l&&(b=!1);break;case "W":l||(b=!1)}}if(b&&(g=a(this).attr("client-list"),"undefined"!=typeof g&&"undefined"!==typeof R))switch(g=b64d(g).split(","),f=a(this).attr("client-list-type"),l=!1,a.each(g,function(t,c){if(""==c)return!0;if("*"==c.charAt(0))if("*"==c.charAt(c.length-1)){if(c=c.substr(1,c.length-2).toLowerCase(),-1!=L.indexOf(c))return l=!0,!1}else{if(c=c.substr(1).toLowerCase(),L.substr(-c.length)==c)return l=!0,!1}else if("*"==c.charAt(c.length-1)){if(c=c.substr(0,c.length-1).toLowerCase(),0==L.indexOf(c))return l=!0,!1}else if(R.is(c))return l=!0,!1}),f){case "B":l&&(b=!1);break;case "W":l||(b=!1)}var M=g=!1;if(b&&(f=a(this).attr("parameter-list"),"undefined"!=typeof f)){f=b64d(f).split(",");var u=a(this).attr("parameter-list-type"),S=[];G.forEach(function(t){t=t.split("=");try{var c=JSON.parse(decodeURIComponent(t[1]))}catch(T){c=decodeURIComponent(t[1])}S[t[0]]=c});var w=!1,H=a(this);a.each(f,function(t,c){var T=c.split("&&");a.each(T,function(X,m){var x=!0;m=m.trim();"!!"==m.substring(0,2)&&(x=!1,m=m.substring(2));var p=m,y="!@!",U=-1!=m.indexOf("["),V=(0==m.indexOf("tcf-v2")||0==m.indexOf("euconsent-v2"))&&-1!=m.indexOf("[");-1!=m.indexOf("=")&&(y=m.split("="),p=y[0],y=y[1],U=-1!=p.indexOf("["),V=(0==p.indexOf("tcf-v2")||0==p.indexOf("euconsent-v2"))&&-1!=p.indexOf("["));if(V)a("#ai-iab-tcf-bar").show(),"object"==typeof ai_tcData?(a("#ai-iab-tcf-bar").addClass("status-ok"),p=p.replace(/]| /gi,"").split("["),p.shift(),w=(p=h(p,ai_tcData,y))?x:!x):(H.addClass("ai-list-data"),M=!0,"function"==typeof __tcfapi?P(!1):"undefined"==typeof ai_tcData_retrying&&(ai_tcData_retrying=!0,setTimeout(function(){P(!0)},200)));else if(U)w=(p=F(S,p,y))?x:!x;else{var N=!1;"!@!"==y?G.every(function(W){return W.split("=")[0]==m?(N=!0,!1):!0}):N=-1!=G.indexOf(m);w=N?x:!x}if(!w)return!1});if(w)return!1});switch(u){case "B":w&&(b=!1);break;case "W":w||(b=!1)}a(this).hasClass("ai-list-manual")&&(b?(H.removeClass("ai-list-data"),H.removeClass("ai-list-manual")):(g=!0,H.addClass("ai-list-data")));if(!g&&!M&&(f=a(this).data("debug-info"),"undefined"!=typeof f&&(f=a("."+f),0!=f.length))){var q=f.parent();q.hasClass("ai-debug-info")&&q.remove()}}q=a(this).prevAll(".ai-debug-bar.ai-debug-lists");f=""==r?"#":r;q.find(".ai-debug-name.ai-list-info").text(f).attr("title",K);q.find(".ai-debug-name.ai-list-status").text(b?ai_front.visible:ai_front.hidden);f=!1;if(b){u=a(this).attr("scheduling-start");var A=a(this).attr("scheduling-end"),B=a(this).attr("scheduling-days");if("undefined"!=typeof u&&"undefined"!=typeof A&&"undefined"!=typeof B){f=!0;var O=parseInt(a(this).attr("scheduling-fallback")),v=parseInt(a(this).attr("gmt"));u=z(b64d(u))+v;A=z(b64d(A))+v;B=b64d(B).split(",");q=a(this).attr("scheduling-type");var C=(new Date).getTime()+v,I=new Date(C),D=I.getDay();0==D?D=6:D--;v=C>=u&&C<A&&B.includes(D.toString());switch(q){case "B":v=!v}v||(b=!1);I=I.toISOString().split(".")[0].replace("T"," ");q=a(this).prevAll(".ai-debug-bar.ai-debug-scheduling");q.find(".ai-debug-name.ai-scheduling-info").text(I+" "+D+" current_time:"+C.toString()+"  start_date:"+u.toString()+" ="+(C>=u).toString()+" end_date:"+A.toString()+" =:"+(C<A).toString()+" days:"+B.toString()+" =:"+B.includes(D.toString()).toString());q.find(".ai-debug-name.ai-scheduling-status").text(b?ai_front.visible:ai_front.hidden);b||0==O||(q.removeClass("ai-debug-scheduling").addClass("ai-debug-fallback"),q.find(".ai-debug-name.ai-scheduling-status").text(ai_front.fallback+"="+O))}}if(g||M)return!0;a(this).css({visibility:"",position:"",width:"",height:"","z-index":""});b?(d.css({visibility:""}),d.hasClass("ai-remove-position")&&d.css({position:""}),"undefined"!=typeof a(this).data("code")&&(b=b64d(a(this).data("code")),0!=a(this).closest("head").length?(a(this).after(b),a(this).remove()):a(this).append(b),ai_process_element(this))):f&&!v&&0!=O?(d.css({visibility:""}),d.hasClass("ai-remove-position")&&d.css({position:""}),a(this).next(".ai-fallback").removeClass("ai-fallback"),"undefined"!=typeof a(this).data("fallback-code")?(b=b64d(a(this).data("fallback-code")),a(this).append(b),ai_process_element(this)):(a(this).hide(),d.find(".ai-debug-block").length||d.hide()),b=d.attr("data-ai"),"undefined"!==typeof b&&!1!==b&&(b=a(this).attr("fallback-tracking"),"undefined"!==typeof b&&!1!==b&&d.attr("data-ai",b))):(a(this).hide(),d.find(".ai-debug-block").length||d.hide(),d.removeAttr("data-ai").removeClass("ai-track"),d.find(".ai-debug-block").length?(d.css({visibility:""}).removeClass("ai-close"),d.hasClass("ai-remove-position")&&d.css({position:""})):d.hide());a(this).attr("data-code","");a(this).attr("data-fallback-code","");d.removeClass("ai-list-block")})}};a(document).ready(function(e){setTimeout(function(){ai_process_lists();setTimeout(function(){n()},50);if("function"==typeof ai_load_blocks)jQuery(document).on("cmplzEnableScripts",function(h){"all"===h.consentLevel&&ai_load_blocks()});jQuery("#ai-iab-tcf-bar").click(function(){AiCookies.remove("euconsent-v2",{path:"/",domain:"."+window.location.hostname});AiCookies.remove("__lxG__consent__v2",{path:"/",domain:"."+window.location.hostname});AiCookies.remove("__lxG__consent__v2_daisybit",{path:"/",domain:"."+window.location.hostname});AiCookies.remove("__lxG__consent__v2_gdaisybit",{path:"/",domain:"."+window.location.hostname});AiCookies.remove("cmplz_marketing",{path:"/",domain:"."+window.location.hostname});AiCookies.remove("cmplz_stats",{path:"/",domain:"."+window.location.hostname});AiCookies.remove("complianz_consent_status",{path:"/",domain:"."+window.location.hostname});jQuery("#ai-iab-tcf-status").text("COOKIE DELETED")})},5)})});function ai_process_element(a){setTimeout(function(){"function"==typeof ai_process_rotations_in_element&&ai_process_rotations_in_element(a);"function"==typeof ai_process_lists&&ai_process_lists(jQuery(".ai-list-data",a));"function"==typeof ai_process_ip_addresses&&ai_process_ip_addresses(jQuery(".ai-ip-data",a));"function"==typeof ai_adb_process_blocks&&ai_adb_process_blocks(a)},5)}function getAllUrlParams(a){var k=a?a.split("?")[1]:window.location.search.slice(1);a={};if(k){k=k.split("#")[0];k=k.split("&");for(var z=0;z<k.length;z++){var n=k[z].split("="),E=void 0,e=n[0].replace(/\[\d*\]/,function(h){E=h.slice(1,-1);return""});n="undefined"===typeof n[1]?"":n[1];e=e.toLowerCase();n=n.toLowerCase();a[e]?("string"===typeof a[e]&&(a[e]=[a[e]]),"undefined"===typeof E?a[e].push(n):a[e][E]=n):a[e]=n}}return a};jQuery(function(a){function t(g,c){c||(c=window.location.href);g=g.replace(/[\[\]]/g,"\\$&");var e=(new RegExp("[?&]"+g+"(=([^&#]*)|&|#|$)")).exec(c);return e?e[2]?decodeURIComponent(e[2].replace(/\+/g," ")):"":null}function u(g){g.removeClass("ai-ip-data");var c=!1;if(""!=ai_ip_data){try{var e=JSON.parse(ai_ip_data),h=e[0],l=e[1],n=e[2],p=e[3]}catch(d){return}var q=h+", "+l;null!=n&&null!=p&&(q=q+":"+n+":"+p);null==n&&(n="");null==p&&(p="");null!=e&&g.each(function(){var d=a(this).closest("div.code-block");c=!0;var f=a(this).attr("ip-addresses");if("undefined"!=typeof f){f=f.split(",");var r=a(this).attr("ip-address-list"),k=!1;a.each(f,function(v,b){if("*"==b.charAt(0))if("*"==b.charAt(b.length-1)){if(b=b.substr(1,b.length-2),-1!=h.indexOf(b))return k=!0,!1}else{if(b=b.substr(1),h.substr(-b.length)==b)return k=!0,!1}else if("*"==b.charAt(b.length-1)){if(b=b.substr(0,b.length-1),0==h.indexOf(b))return k=!0,!1}else if("#"==b){if(""==h)return k=!0,!1}else if(b==h)return k=!0,!1});switch(r){case "B":k&&(c=!1);break;case "W":k||(c=!1)}}if(c&&(f=a(this).attr("countries"),"undefined"!=typeof f))switch(f=f.split(","),r=a(this).attr("country-list"),k=!1,a.each(f,function(v,b){var m=b.trim().split(":");if(null==m[1]||""==n)m[1]="";if(null==m[2]||""==p)m[2]="";var w=m.join(":").toUpperCase();m=(l+":"+(""==m[1]?"":n)+":"+(""==m[2]?"":p)).toUpperCase();if(w==m)return k=!0,!1}),r){case "B":k&&(c=!1);break;case "W":k||(c=!1)}a(this).css({visibility:"",position:"",width:"",height:"","z-index":""});f=a(this).prev(".ai-debug-bar");f.find(".ai-debug-name.ai-ip-country").text(q);f.find(".ai-debug-name.ai-ip-status").text(c?ai_front.visible:ai_front.hidden);c?(d.css({visibility:""}),d.hasClass("ai-remove-position")&&d.css({position:""}),"undefined"!=typeof a(this).data("code")&&(f=b64d(a(this).data("code")),0!=a(this).closest("head").length?(a(this).after(f),a(this).remove()):a(this).append(f),a(this).attr("data-code",""),ai_process_element(this))):(a(this).hide(),d.find(".ai-debug-block").length||d.hide(),d.removeAttr("data-ai"),d.find(".ai-debug-block")?(d.css({visibility:""}).removeClass("ai-close"),d.hasClass("ai-remove-position")&&d.css({position:""}),"undefined"!=typeof a(this).data("code")&&(d.removeClass("ai-list-block"),d.prev().hasClass("ai-debug-info")&&d.prev().remove())):d.hide());d.removeClass("ai-list-block-ip")})}}ai_process_ip_addresses=function(g){g=null==g?a("div.ai-ip-data, meta.ai-ip-data"):g.filter(".ai-ip-data");if(g.length)if("undefined"!=typeof ai_ip_data)u(g);else if("undefined"==typeof ai_ip_data_requested){ai_ip_data_requested=!0;var c="/wp-admin/admin-ajax.php?action=ai_ajax&ip-data=ip-address-country-city&ai_check=e25a7b7809&ver="+((new Date).getTime()+"-"+Math.round(1E5*Math.random())),e=t("ai-debug-ip-address");null!=e&&(c+="&ai-debug-ip-address="+e);e=t("ai-debug-country");null!=e&&(c+="&ai-debug-country="+e);a.get(c,function(h){ai_ip_data=h;if(""==h){var l="Ajax request returned empty data, geo-targeting disabled";console.error(l);"undefined"!=typeof ai_js_errors&&ai_js_errors.push([l,c,0])}else try{JSON.parse(h)}catch(n){l="Ajax call returned invalid data, geo-targeting disabled",console.error(l,h),"undefined"!=typeof ai_js_errors&&ai_js_errors.push([l,c,0])}u(g)}).fail(function(h,l,n){a("div.ai-ip-data").each(function(){a(this).css({display:"none",visibility:"",position:"",width:"",height:"","z-index":""}).removeClass("ai-ip-data").hide()})})}};a(document).ready(function(g){setTimeout(function(){ai_process_ip_addresses()},5)})});function ai_process_element(a){setTimeout(function(){"function"==typeof ai_process_rotations_in_element&&ai_process_rotations_in_element(a);"function"==typeof ai_process_lists&&ai_process_lists(jQuery(".ai-list-data",a));"function"==typeof ai_process_ip_addresses&&ai_process_ip_addresses(jQuery(".ai-ip-data",a));"function"==typeof ai_adb_process_blocks&&ai_adb_process_blocks(a)},5)};ai_run_257222971322 = function(){ai_document_write=document.write;document.write=function(a){"interactive"==document.readyState?(console.error("document.write called after page load: ",a),"undefined"!=typeof ai_js_errors&&ai_js_errors.push(["document.write called after page load",a,0])):ai_document_write.call(document,a)};ai_insert ('after', '.lwptoc', b64d ('PGRpdiBjbGFzcz0nY29kZS1ibG9jayBjb2RlLWJsb2NrLWRlZmF1bHQgY29kZS1ibG9jay0xMCBhaS12aWV3cG9ydC0zJz4KPGEgaHJlZj0iL2luc3RhLyIgcmVsPSJub2ZvbGxvdyIgdGFyZ2V0PSJfYmxhbmsiPjxpbWcgc3JjPSIvYi9wYW1tX2xhbmRpbmdfYmFubmVyXzMwMHgyNTBfcnVfLmdpZiIvPjwvYT4KPC9kaXY+Cg=='));};if (document.readyState === 'complete' || (document.readyState !== 'loading' && !document.documentElement.doScroll)) ai_run_257222971322 (); else document.addEventListener ('DOMContentLoaded', ai_run_257222971322);ai_js_code = true;</script> </body></html>